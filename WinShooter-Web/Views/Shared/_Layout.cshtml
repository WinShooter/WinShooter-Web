@using System.Diagnostics
<!DOCTYPE html>
<html ng-app="winshooter">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>WinShooter @ViewBag.CompetitionName</title>
    @Styles.Render("~/Content/styles")
    @Styles.Render("~/Content/cookieStyles.css")
    @Scripts.Render("~/bundles/modernizr")

    @{
        var htmlLinkAboutClass = string.Empty;
        var htmlLinkClubsClass = string.Empty;
        var htmlLinkCompetitionClass = string.Empty;
        var htmlLinkCompetitorsClass = string.Empty;
        var htmlLinkEnterResultsClass = string.Empty;
        var htmlLinkManageCompetitionRightsClass = string.Empty;
        var htmlLinkPatrolsClass = string.Empty;
        var htmlLinkPrivacyClass = string.Empty;
        var htmlLinkResultsClass = string.Empty;
        var htmlLinkStationsClass = string.Empty;
        var htmlLinkWeaponsClass = string.Empty;
        if (ViewContext.Controller.GetType().Name == "HomeController")
        {
            switch (ViewContext.Controller.ValueProvider.GetValue("action").RawValue.ToString().ToUpper())
            {
                case "INDEX":
                // Don't do anything
                    break;
                case "ABOUT":
                    htmlLinkAboutClass = "active";
                    break;
                case "CLUBS":
                    htmlLinkClubsClass = "active";
                    break;
                case "COMPETITION":
                    htmlLinkCompetitionClass = "active";
                    break;
                case "COMPETITORS":
                    htmlLinkCompetitorsClass = "active";
                    break;
                case "ENTERRESULTS":
                    htmlLinkEnterResultsClass = "active";
                    break;
                case "MANAGECOMPETITIONRIGHTS":
                    htmlLinkManageCompetitionRightsClass = "active";
                    break;
                case "PATROLS":
                    htmlLinkPatrolsClass = "active";
                    break;
                case "PRIVACY":
                    htmlLinkPrivacyClass = "active";
                    break;
                case "RESULTS":
                    htmlLinkResultsClass = "active";
                    break;
                case "STATIONS":
                    htmlLinkStationsClass = "active";
                    break;
                case "WEAPONS":
                    htmlLinkWeaponsClass = "active";
                    break;
                case "NEWCOMPETITION":
                    // Don't display menu when adding new competition.
                    break;
                default:
                    Debug.WriteLine("Unhandled action: " + ViewContext.Controller.ValueProvider.GetValue("action").RawValue.ToString().ToUpper());
                    break;
            }
        }
    }
</head>
    <body>
        <div ng-controller="CurrentUserController">
            <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Visa menu</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/" ng-click="openHome()">WinShooter</a>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li class="@htmlLinkCompetitionClass"><a href ng-show="shouldShowCompetitionLink" ng-click="openCompetition()">Tävling</a></li>
                            <li class="@htmlLinkClubsClass"><a href="/Home/Clubs" ng-show="shouldShowEditClubsLink" ng-click="openClubs()">Klubbar</a></li>
                            <li class="@htmlLinkWeaponsClass"><a href="/Home/Weapons" ng-show="shouldShowEditWeaponsLink" ng-click="openWeapons()">Vapen</a></li>
                            <li class="@htmlLinkStationsClass"><a href ng-show="shouldShowStationsLink" ng-click="openStations()">Stationer</a></li>
                            <li class="@htmlLinkPatrolsClass"><a href ng-show="shouldShowPatrolsLink" ng-click="openPatrols()">Patruller</a></li>
                            <li class="@htmlLinkCompetitorsClass"><a href ng-show="shouldShowCompetitorsLink" ng-click="openCompetitors()">Tävlande</a></li>
                            <li class="@htmlLinkEnterResultsClass"><a href ng-show="shouldShowAddResultsLink" ng-click="openEnterResults()">Resultatinmatning</a></li>
                            <li class="@htmlLinkResultsClass"><a href ng-show="shouldShowAddResultsLink" ng-click="openResults()">Resultat</a></li>
                            <li class="@htmlLinkManageCompetitionRightsClass"><a href ng-show="shouldShowEditRightsLink">Rättigheter</a></li>

                            <li class="@htmlLinkAboutClass"><a href ng-show="shouldShowAboutLink" ng-click="openAbout()">Om WinShooter</a></li>
                            <li class="@htmlLinkPrivacyClass"><a href ng-show="shouldShowPrivacyLink" ng-click="openPrivacy()">Privacy</a></li>
                            <li>
                                <a href="/Account/Login" ng-show="shouldShowLoginLink">Logga in</a>
                                <a href="/api/auth/logout" target="_self" ng-show="isLoggedIn">Logga ut</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="cookieMessageWrapper">
                <div id="cookieMessage">
                    <a id="cookieClose" href="#">Stäng</a>
                    <p><strong>WinShooter använder kakor ("cookies").</strong> Du kan läsa mer om hur vi använder dem <a href ng-click="openPrivacy()">här</a>.</p>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="winshooter-template">
                @RenderBody()
            </div>
        </div>

        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")
        @Scripts.Render("~/bundles/angularjs")
        @Scripts.Render("~/bundles/angularjs-route");
        @Scripts.Render("~/bundles/angularjs-resource")
        @Scripts.Render("~/bundles/angularjs-bootstrapui")
        @Scripts.Render("~/bundles/angularjs-sanitize")
        @Scripts.Render("~/bundles/angulari18n/sv-se")
        @Scripts.Render("~/Scripts/App/common.js")
        @Scripts.Render("~/Scripts/App/AngularModules.js")
        @Scripts.Render("~/Scripts/App/cookieScript.js")

        <!-- fallback for CDN -->
        <script>
            // Fallback to loading jQuery from a local path if the CDN is unavailable
            (window.jQuery === undefined && document.write('<script src="@Url.Content("~/Scripts/jquery-2.0.3.js")"><\/script>'));
        </script>
    
        <!-- The modal confirmation dialog -->
        <script type="text/ng-template" id="confirmationModalContent">
        <div class="modal-header">
            <h4 class="modal-title">{{header}}</h4>
        </div>
        <div class="modal-body">
            <p>
                {{body}}
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-ng-click="ok()">Ja</button>
            <button type="button" class="btn btn-warning" data-ng-click="cancel()">Nej</button>
        </div>
    </script>
    
        <!-- The modal error dialog -->
        <script type="text/ng-template" id="errorModalContent">
        <div class="modal-header">
            <h4 class="modal-title">{{header}}</h4>
        </div>
        <div class="modal-body">
            <p ng-bind-html="body">
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-ng-click="ok()">OK</button>
        </div>
    </script>

        <!-- The modal information dialog -->
        <script type="text/ng-template" id="informationModalContent">
        <div class="modal-header">
            <h4 class="modal-title">{{header}}</h4>
        </div>
        <div class="modal-body">
            <p ng-bind-html="body">
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-ng-click="ok()">OK</button>
        </div>
    </script>

        @RenderSection("scripts", required: false)
        @{ Html.RenderPartial("~/Views/Shared/_GoogleAnalytics.cshtml"); }
    </body>
</html>

